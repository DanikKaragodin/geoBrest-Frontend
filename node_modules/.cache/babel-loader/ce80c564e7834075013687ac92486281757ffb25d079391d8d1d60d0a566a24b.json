{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/Danik/inform_kurs/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/Danik/inform_kurs/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";//import { Text, StyleSheet, View } from 'react-native'\nimport React,{Component,useContext,useEffect}from'react';import{useNavigate}from'react-router-dom';import\"../Styles/main.css\";import{DriverContext}from'./Contexts/driverContext';import axios from'axios';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function Inform(){var navigate=useNavigate();var _useContext=useContext(DriverContext),Driver=_useContext.Driver,updateValues=_useContext.updateValues;useEffect(function(){console.log(\"subcribe\");subscribe();},[]);function WorkStatus(){if(Driver.is_sleeping){return/*#__PURE__*/_jsx(\"h1\",{className:\"info-main-h1\",children:\"\\u0412\\u043E\\u0434\\u0438\\u0442\\u0435\\u043B\\u044C \\u0441\\u043F\\u0438\\u0442\"});}if(Driver.is_breaking){return/*#__PURE__*/_jsx(\"h1\",{className:\"info-main-h1\",children:\"\\u0412\\u043E\\u0434\\u0438\\u0442\\u0435\\u043B\\u044C \\u043E\\u0442\\u0434\\u044B\\u0445\\u0430\\u0435\\u0442\"});}return/*#__PURE__*/_jsx(\"ul\",{className:\"info-main-ul\",id:\"info-main-ul\",children:Driver.currentPath.map(function(stopOver,index){if(index>=Driver.indexStopOver)return/*#__PURE__*/_jsxs(\"li\",{className:\"info-main-li\",id:\"info-main-li\",children:[/*#__PURE__*/_jsx(\"p\",{id:\"info-main-li-stopover\",children:stopOver}),/*#__PURE__*/_jsxs(\"p\",{id:\"info-main-li-count\",children:[Driver.stopOversSizes[index],\" \\u0447\\u0435\\u043B.\"]})]},stopOver+index);})});}function subscribe(){return _subscribe.apply(this,arguments);}function _subscribe(){_subscribe=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var _yield$axios$get,data;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.prev=0;if(Driver.token){_context.next=3;break;}return _context.abrupt(\"return\",false);case 3:_context.next=5;return axios.get('/info',{headers:{Authorization:\"Bearer \".concat(Driver.token)}});case 5:_yield$axios$get=_context.sent;data=_yield$axios$get.data;updateValues({hours:data.Info[0].hours,minutes:data.Info[0].minutes,seconds:data.Info[0].seconds,koef:data.Info[0].koef,indexStopOver:data.Info[1].indexStopOver,is_recursive:data.Info[1].is_recursive,is_breaking:data.Info[1].is_breaking,breaking_in_min:data.Info[1].breaking_in_min,is_sleeping:data.Info[1].is_sleeping,sizeOfPaths:data.Info[1].sizeOfPaths,currentPath:data.Info[1].currentPath,passengersSize:data.Info[1].PassengersIndexes.length,stopOversSizes:data.Info[2]});setTimeout(function(){subscribe();},1000/Driver.koef);_context.next=14;break;case 11:_context.prev=11;_context.t0=_context[\"catch\"](0);setTimeout(function(){subscribe();},1000/Driver.koef);case 14:case\"end\":return _context.stop();}},_callee,null,[[0,11]]);}));return _subscribe.apply(this,arguments);}function Exit(){console.log('Exit');localStorage.removeItem(\"token\");navigate(\"/login\");}return/*#__PURE__*/_jsxs(\"div\",{className:\"info-div\",id:\"info-div\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"info-header\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"info-header-div-imgName\",id:\"info-header-div-imgName\",children:/*#__PURE__*/_jsx(\"p\",{className:\"info-header-count\",id:\"info-header-name\",children:Driver.fullname})}),/*#__PURE__*/_jsx(\"div\",{className:\"info-header-count\",children:/*#__PURE__*/_jsxs(\"p\",{className:\"info-header-count-p\",id:\"info-header-count-p\",children:[\" \\u0422\\u0430\\u043A\\u0441\\u0438 \\u2116\",Driver.busId,\" | \\u0417\\u0430\\u043D\\u044F\\u0442\\u043E\\u0441\\u0442\\u044C: \",Driver.passengersSize,\"/\",Driver.max_passengers,\" \"]})}),/*#__PURE__*/_jsx(\"div\",{className:\"info-header-count\",children:/*#__PURE__*/_jsxs(\"p\",{className:\"info-header-count-p\",id:\"info-header-count-time\",children:[\" \",Driver.hours,\" : \",Driver.minutes,\" : \",Driver.seconds,\" , \",Driver.koef,\" \"]})})]}),/*#__PURE__*/_jsx(\"div\",{className:\"info-main\",children:/*#__PURE__*/_jsx(WorkStatus,{})}),/*#__PURE__*/_jsx(\"div\",{className:\"info-main\",children:/*#__PURE__*/_jsx(\"button\",{onClick:Exit,className:\"info-main-button\",children:\" \\u0412\\u044B\\u0439\\u0442\\u0438 \"})})]});}","map":{"version":3,"names":["React","Component","useContext","useEffect","useNavigate","DriverContext","axios","jsx","_jsx","jsxs","_jsxs","Inform","navigate","_useContext","Driver","updateValues","console","log","subscribe","WorkStatus","is_sleeping","className","children","is_breaking","id","currentPath","map","stopOver","index","indexStopOver","stopOversSizes","_subscribe","apply","arguments","_asyncToGenerator","_regeneratorRuntime","mark","_callee","_yield$axios$get","data","wrap","_callee$","_context","prev","next","token","abrupt","get","headers","Authorization","concat","sent","hours","Info","minutes","seconds","koef","is_recursive","breaking_in_min","sizeOfPaths","passengersSize","PassengersIndexes","length","setTimeout","t0","stop","Exit","localStorage","removeItem","fullname","busId","max_passengers","onClick"],"sources":["C:/Users/Danik/inform_kurs/src/Components/Inform.jsx"],"sourcesContent":["//import { Text, StyleSheet, View } from 'react-native'\r\nimport React, { Component,useContext,useEffect } from 'react'\r\nimport {useNavigate} from 'react-router-dom';\r\nimport \"../Styles/main.css\";\r\nimport { DriverContext } from './Contexts/driverContext';\r\nimport axios from 'axios';\r\nexport default function Inform()  {\r\n  const navigate = useNavigate();\r\n  const {Driver, updateValues} = useContext(DriverContext);\r\n  useEffect(() => {\r\n    console.log(\"subcribe\");\r\n    subscribe();\r\n  }, [])\r\n  function WorkStatus(){\r\n    if(Driver.is_sleeping){\r\n      return <h1 className=\"info-main-h1\">Водитель спит</h1>\r\n    }\r\n    if(Driver.is_breaking){\r\n      return <h1 className=\"info-main-h1\">Водитель отдыхает</h1>\r\n    }\r\n    return (\r\n      <ul className=\"info-main-ul\" id=\"info-main-ul\">\r\n      {Driver.currentPath.map((stopOver,index) => {\r\n        if(index >= Driver.indexStopOver)\r\n        return(\r\n          <li key={stopOver+index} className=\"info-main-li\" id=\"info-main-li\"> \r\n          <p id=\"info-main-li-stopover\">{stopOver}</p>\r\n          <p id=\"info-main-li-count\">{Driver.stopOversSizes[index]} чел.</p>\r\n          </li>);\r\n      })}\r\n    </ul>\r\n    )\r\n  }\r\n  async function subscribe(){\r\n    try {\r\n        if(!Driver.token) return false\r\n        const {data} = await axios.get('/info',\r\n        {headers: {Authorization: `Bearer ${Driver.token}`}}\r\n        )\r\n        updateValues({\r\n          hours: data.Info[0].hours,\r\n          minutes: data.Info[0].minutes,\r\n          seconds: data.Info[0].seconds,\r\n          koef: data.Info[0].koef,\r\n          indexStopOver: data.Info[1].indexStopOver,\r\n          is_recursive: data.Info[1].is_recursive,\r\n          is_breaking: data.Info[1].is_breaking,\r\n          breaking_in_min: data.Info[1].breaking_in_min,\r\n          is_sleeping: data.Info[1].is_sleeping,\r\n          sizeOfPaths: data.Info[1].sizeOfPaths,\r\n          currentPath: data.Info[1].currentPath,\r\n          passengersSize: data.Info[1].PassengersIndexes.length,\r\n          stopOversSizes: data.Info[2],\r\n        });\r\n        setTimeout(() => {\r\n           subscribe();\r\n        }, (1000/Driver.koef));\r\n        \r\n    } catch (e) {\r\n        setTimeout(() => {\r\n            subscribe();\r\n        }, (1000/Driver.koef))\r\n    }\r\n  }\r\n  function Exit(){\r\n    console.log('Exit');\r\n    localStorage.removeItem(\"token\");\r\n    navigate(\"/login\");\r\n  }\r\n  return (\r\n        <div className=\"info-div\" id=\"info-div\">\r\n        <div className=\"info-header\">\r\n          <div className=\"info-header-div-imgName\"id=\"info-header-div-imgName\">\r\n          \r\n          <p className=\"info-header-count\" id=\"info-header-name\">{Driver.fullname}</p>\r\n          \r\n          </div>\r\n          <div className=\"info-header-count\">\r\n            <p className=\"info-header-count-p\" id=\"info-header-count-p\"> Такси №{Driver.busId} | Занятость: {Driver.passengersSize}/{Driver.max_passengers} </p>\r\n          </div>\r\n          <div className=\"info-header-count\">\r\n            <p className=\"info-header-count-p\" id=\"info-header-count-time\"> {Driver.hours} : {Driver.minutes} : {Driver.seconds} , {Driver.koef} </p>\r\n          </div>\r\n        </div>\r\n        <div className=\"info-main\">\r\n          <WorkStatus/>\r\n        </div>\r\n        <div className='info-main'>\r\n              <button onClick={Exit} className='info-main-button'> Выйти </button>\r\n        </div>\r\n      </div>\r\n    )\r\n}"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}